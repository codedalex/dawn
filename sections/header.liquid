{% comment %}sections/header.liquid{% endcomment %}

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "header",
      "content": "Layout Settings"
    },
    {
      "type": "select",
      "id": "header_style",
      "label": "Header Style",
      "options": [
        {
          "value": "default",
          "label": "Default"
        },
        {
          "value": "centered",
          "label": "Centered"
        },
        {
          "value": "minimal",
          "label": "Minimal"
        },
        {
          "value": "expanded",
          "label": "Expanded"
        },
        {
          "value": "compact",
          "label": "Compact"
        },
        {
          "value": "split",
          "label": "Split"
        }
      ],
      "default": "default"
    },
    {
      "type": "checkbox",
      "id": "sticky_header",
      "label": "Enable sticky header",
      "default": true
    },
    {
      "type": "header",
      "content": "Mobile Menu Settings"
    },
    {
      "type": "checkbox",
      "id": "show_mobile_menu",
      "label": "Show mobile menu",
      "default": true
    },
    {
      "type": "select",
      "id": "mobile_menu_position",
      "label": "Mobile menu position",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ],
      "default": "left"
    }
  ],
  "blocks": [
    {
        "type": "logo",
        "name": "Logo",
        "limit": 1,
        "settings": [
          {
            "type": "checkbox",
            "id": "show_logo",
            "label": "Show logo",
            "default": true
          },
          {
            "type": "header",
            "content": "Logo Settings"
          },
          {
            "type": "image_picker",
            "id": "logo",
            "label": "Logo"
          },
          {
            "type": "image_picker", 
            "id": "logo_mobile",
            "label": "Mobile Logo",
            "info": "Optional different logo for mobile devices"
          },
          {
            "type": "range",
            "id": "logo_width",
            "min": 50,
            "max": 350,
            "step": 10,
            "unit": "px",
            "label": "Logo width",
            "default": 140
          },
          {
            "type": "range",
            "id": "logo_width_mobile",
            "min": 50,
            "max": 200,
            "step": 10,
            "unit": "px",
            "label": "Mobile logo width",
            "default": 100
          },
          {
            "type": "range",
            "id": "logo_height",
            "min": 20,
            "max": 200,
            "step": 5,
            "unit": "px",
            "label": "Logo height",
            "default": 50,
            "info": "Set to 0 to maintain aspect ratio"
          },
          {
            "type": "select",
            "id": "logo_alignment",
            "label": "Logo alignment",
            "options": [
              {
                "value": "left",
                "label": "Left"
              },
              {
                "value": "center",
                "label": "Center"
              },
              {
                "value": "right", 
                "label": "Right"
              }
            ],
            "default": "left"
          },
          {
            "type": "checkbox",
            "id": "home_page_only",
            "label": "Link to home page only",
            "default": false
          },
          {
            "type": "range",
            "id": "height_constraint",
            "min": 30,
            "max": 200, 
            "step": 10,
            "unit": "px",
            "label": "Container height",
            "default": 50,
            "info": "Set a fixed height for the logo container"
          }
        ]
      },
      {
        "type": "menu",
        "name": "Menu",
        "limit": 1,
        "settings": [
          {
            "type": "header",
            "content": "Menu Display"
          },
          {
            "type": "checkbox",
            "id": "show_menu",
            "label": "Show menu",
            "default": true
          },
          {
            "type": "select",
            "id": "nav_position",
            "label": "Navigation Position",
            "options": [
              {
                "value": "inline",
                "label": "Inline with header"
              },
              {
                "value": "below",
                "label": "Below header"
              }
            ],
            "default": "inline"
          },
          {
            "type": "select",
            "id": "nav_alignment",
            "label": "Menu Alignment",
            "options": [
              {
                "value": "left",
                "label": "Left"
              },
              {
                "value": "center", 
                "label": "Center"
              },
              {
                "value": "right",
                "label": "Right"
              }
            ],
            "default": "center"
          },
          {
            "type": "header",
            "content": "Menu Items"
          },
          {
            "type": "select",
            "id": "menu_type",
            "label": "Menu Type",
            "options": [
              {
                "value": "simple",
                "label": "Simple Menu"
              },
              {
                "value": "mega",
                "label": "Mega Menu"
              },
              {
                "value": "dropdown",
                "label": "Dropdown Menu"
              },
              {
                "value": "featured",
                "label": "Featured Menu"
              }
            ],
            "default": "simple"
          },
          {
            "type": "link_list",
            "id": "menu",
            "label": "Menu"
          },
          {
            "type": "header",
            "content": "Mega Menu Settings",
            "info": "These settings apply only to mega menu type"
          },
          {
            "type": "select",
            "id": "mega_width",
            "label": "Menu Width",
            "options": [
              {
                "value": "container",
                "label": "Container width"
              },
              {
                "value": "full",
                "label": "Full width"
              }
            ],
            "default": "container"
          },
          {
            "type": "collection",
            "id": "featured_collection",
            "label": "Featured Collection"
          },
          {
            "type": "product_list",
            "id": "featured_products",
            "label": "Featured Products",
            "limit": 4
          },
          {
            "type": "header",
            "content": "Dropdown Settings",
            "info": "These settings apply to dropdown and simple menu types"
          },
          {
            "type": "range",
            "id": "dropdown_width",
            "min": 150,
            "max": 400,
            "step": 10,
            "unit": "px",
            "label": "Dropdown width",
            "default": 200
          },
          {
            "type": "image_picker",
            "id": "featured_image",
            "label": "Featured Image",
            "info": "For featured menu type"
          }
        ]
      },
    {
        "type": "icons",
        "name": "Header Icons",
        "limit": 1,
        "settings": [
          {
            "type": "header",
            "content": "Icon Display"
          },
          {
            "type": "checkbox",
            "id": "show_icons",
            "label": "Show header icons",
            "default": true,
            "info": "Controls visibility of all header icons"
          },
          {
            "type": "header",
            "content": "Individual Icons"
          },
          {
            "type": "checkbox",
            "id": "show_search",
            "label": "Show search icon",
            "default": true
          },
          {
            "type": "checkbox", 
            "id": "show_account",
            "label": "Show account icon",
            "default": true,
            "info": "Requires customer accounts to be enabled"
          },
          {
            "type": "checkbox",
            "id": "show_wishlist",
            "label": "Show wishlist icon",
            "default": true
          },
          {
            "type": "checkbox",
            "id": "show_cart",
            "label": "Show cart icon",
            "default": true
          },
          {
            "type": "header",
            "content": "Icon Style Settings"
          },
          {
            "type": "select",
            "id": "icon_size",
            "label": "Icon size",
            "options": [
              {
                "value": "small",
                "label": "Small"
              },
              {
                "value": "medium",
                "label": "Medium"
              },
              {
                "value": "large",
                "label": "Large"
              }
            ],
            "default": "medium"
          },
          {
            "type": "select",
            "id": "icon_style",
            "label": "Icon style",
            "options": [
              {
                "value": "default",
                "label": "Default"
              },
              {
                "value": "filled",
                "label": "Filled"
              },
              {
                "value": "outline",
                "label": "Outline"
              }
            ],
            "default": "default"
          },
          {
            "type": "header",
            "content": "Counter Badge Settings"
          },
          {
            "type": "checkbox",
            "id": "show_count",
            "label": "Show count badges",
            "default": true,
            "info": "Shows item count for cart and wishlist"
          },
          {
            "type": "select",
            "id": "count_style",
            "label": "Counter badge style",
            "options": [
              {
                "value": "circle",
                "label": "Circle"
              },
              {
                "value": "pill",
                "label": "Pill"
              },
              {
                "value": "square",
                "label": "Square"
              }
            ],
            "default": "circle"
          },
          {
            "type": "color",
            "id": "count_background",
            "label": "Counter badge background",
            "default": "#000000"
          },
          {
            "type": "color", 
            "id": "count_text_color",
            "label": "Counter badge text color",
            "default": "#FFFFFF"
          }
        ]
      }
  ],
  "presets": [
    {
      "name": "Header",
      "blocks": [
        {
          "type": "logo"
        },
        {
          "type": "menu"
        },
        {
          "type": "icons"
        }
      ]
    }
  ],
  
}
{% endschema %}

<header id="header" 
        class="header-{{ section.settings.header_style }} {% if section.settings.sticky_header %}is-sticky{% endif %}"
        data-section-id="{{ section.id }}" 
        data-section-type="header">
  <div class="px_15 lg-px_40">
    <div class="row wrapper-header align-items-center">
      
      {% comment %}Mobile Menu Toggle{% endcomment %}
      {% if section.settings.show_mobile_menu %}
        <div class="col-md-4 col-3 tf-lg-hidden">
          {% render 'mobile-menu-toggle', 
            position: section.settings.mobile_menu_position
          %}
        </div>
      {% endif %}

      {% comment %}Header Blocks (Logo, Menu, Icons){% endcomment %}
      {% for block in section.blocks %}
        {% case block.type %}

          {% when 'logo' %}
            {% if block.settings.show_logo %}
              {% render 'header-logo',
                section: section,
                block: block
              %}
            {% endif %}

          {% when 'menu' %}
            {% if block.settings.show_menu %}
              {% render 'header-navigation',
                section: section,
                block: block
              %}
            {% endif %}

          {% when 'icons' %}
            {% if block.settings.show_icons %}
              {% render 'header-icons',
                section: section,
                block: block
              %}
            {% endif %}

        {% endcase %}
      {% endfor %}

    </div>
  </div>
</header>

{% comment %}Add header styles based on selected layout{% endcomment %}
{% style %}
  {% case section.settings.header_style %}
    {% when 'default' %}
      /* Default header styles */
    {% when 'centered' %}
      .header-centered .wrapper-header {
        justify-content: center;
        text-align: center;
      }
    {% when 'minimal' %}
      .header-minimal {
        padding: 10px 0;
      }
    {% when 'expanded' %}
      .header-expanded {
        padding: 20px 0;
      }
    {% when 'compact' %}
      .header-compact {
        padding: 5px 0;
      }
    {% when 'split' %}
      .header-split .wrapper-header {
        justify-content: space-between;
      }
  {% endcase %}

  .header.is-sticky {
    position: sticky;
    top: 0;
    z-index: 1000;
    background: #fff;
    transition: transform 0.3s ease;
  }
{% endstyle %}

{% javascript %}
  class Header {
    constructor() {
      this.header = document.getElementById('header');
      this.lastScrollTop = 0;
      
      if (this.header) {
        this.init();
      }
    }

    init() {
      if (this.header.classList.contains('is-sticky')) {
        window.addEventListener('scroll', this.handleScroll.bind(this));
      }
    }

    handleScroll() {
      const st = window.pageYOffset;
      
      if (st > this.lastScrollTop) {
        // Scrolling down
        this.header.style.transform = 'translateY(-100%)';
      } else {
        // Scrolling up
        this.header.style.transform = 'translateY(0)';
      }
      
      this.lastScrollTop = st;
    }
  }

  // Initialize header
  new Header();
{% endjavascript %}